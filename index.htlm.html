<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carte Isochrones Bibliothèques</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-ajax/dist/leaflet.ajax.min.js"></script>

<style>
  body { margin:0; padding:0; }
  #map { height: 90vh; width: 100vw; }
  #controls { padding: 10px; background: #f9f9f9; }
  #controls label { margin-right: 15px; }
</style>
</head>
<body>

<div id="controls">
  <strong>Afficher les isochrones :</strong>
  <label><input type="checkbox" class="iso-checkbox" data-layer="layerIsochrones" checked> Tous</label>
</div>

<div id="map"></div>

<script>
// Initialisation de la carte centrée sur Digne-les-Bains
var map = L.map('map').setView([44.0833, 6.2333], 11);

// Fond OpenStreetMap
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap contributors'
}).addTo(map);

// --- Charger le GeoJSON depuis le même dépôt GitHub ---
var layerIsochrones = new L.GeoJSON.AJAX(
  "isochrone_voiture_bibi.geojson",
  {
    style: function(feature) {
      return {
        color: 'blue',
        weight: 2,
        fillOpacity: 0.3
      };
    },
    onEachFeature: function(feature, layer) {
      if(feature.properties && feature.properties.name) {
        layer.bindPopup("<b>" + feature.properties.name + "</b>");
      }
    }
  }
).addTo(map);

// --- Gestion de l'affichage via la case à cocher ---
var checkboxes = document.querySelectorAll(".iso-checkbox");
checkboxes.forEach(function(cb) {
  cb.addEventListener('change', function(e) {
    if(cb.checked) map.addLayer(layerIsochrones);
    else map.removeLayer(layerIsochrones);
  });
});
</script>

</body>
</html>
